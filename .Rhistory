train <- read.csv("DigitRecognizer/train.csv")
test <- read.csv("DigitRecognizer/test.csv")
sample_submission <- read.csv("DigitRecognizer/sample_submission.csv")
str(train)
class(train)
source('~/GitHub/Kaggle/DigitRecognizer/digit1.R', echo=TRUE)
dim(train)
head(names(train))
tail(names(train))
table(train$label)
table(train$pixel500)
train %>% names
remove.packages("sFFLHD", lib="~/R/win-library/3.3")
install.packages("sFFLHD")
s <- sFFLHD$new(D=2,L=3)
library(sFFLHD)
s <- sFFLHD$new(D=2,L=3)
s$get.batch()
s$get.batch()
s$get.batch()
s$get.batch()
s$get.batch()
s$get.batch()
s$get.batch()
mat <- matrix(1:12, ncol=2)
split_matrix(mat, 4, shuffle=FALSE)
split_matrix(mat, 4, shuffle=TRUE)
split_matrix(mat, nsplits=4, shuffle=FALSE)
mat
split_matrix(mat, nsplits=2, shuffle=F)
split_matrix(mat, 3, shuffle=F)
train <- read.csv("DigitRecognizer/train.csv")
test <- read.csv("DigitRecognizer/test.csv")
sample_submission <- read.csv("DigitRecognizer/sample_submission.csv")
class(train)
dim(train)
head(names(train))
tail(names(train))
table(train$label)
table(train$pixel500)
head(names(train))
fit <- lm(label ~ ., train)
pred <- predict(fit, test)
str(pred)
dim(test)
head(names(test))
train_ind <- sample(1:nrow(trainALL), size = .7*nrow(trainALL), replace = F)
trainALL <- read.csv("DigitRecognizer/train.csv")
train_ind <- sample(1:nrow(trainALL), size = .7*nrow(trainALL), replace = F)
train <- trainALL[train_ind,]
test <- trainALL[-train_ind,]
fit <- lm(label ~ ., train)
pred <- predict(fit, test)
table(pred, test$label)
str(pred)
head(train$label)
round(2.6)
round(2.4)
pred <- round(predict(fit, test))
table(pred, test$label)
pred[pred < 0] <- 0
pred[pred > 9] <- 9
table(pred, test$label)
sum(pred == test$label) / length(pred)
fitlog <- glm(label~., family=binomial(link='logit'), data=train)
library(nnet)
fitlog <- multinom(label ~ ., data=train)
str(fitlog)
fitlog <- multinom(label ~ ., data=train[1:1000,])
fitlog <- multinom(as.factor(label) ~ ., data=train[1:1000,])
MASS::birthwt
MASS::birthwt %>% head
library(magrittr)
MASS::birthwt %>% head
MASS::birthwt$low
fitlog <- multinom(factor(label) ~ ., data=train[1:1000,])
fitlog <- multinom(factor(label) ~ ., data=train[1:1000,], maxNWts=1e6)
fitlog <- multinom(factor(label) ~ ., data=train[1:1000,], MaxNWts=1e6)
str(fitlog)
predlog <- predict(fitlog, test)
predlog[predlog < 0] <- 0
predlog[predlog > 9] <- 9
str(predlog)
table(predlog, test$label)
sum(predlog == test$label) / length(predlog) # 23.5% accurate
fitlog <- multinom(factor(label) ~ ., data=train, MaxNWts=1e6)
rm(fit);rm(trainALL);rm(sample_submission)
predlog <- predict(fitlog, test)
table(predlog, test$label)
sum(predlog == test$label) / length(predlog)
fitnet <- nnet(factor(label) ~ ., data=train, MaxNWts=1e6, maxit=200)
fitnet <- nnet(factor(label) ~ ., data=train, MaxNWts=1e6, maxit=200,size=20)
str(fitnet)
prednet <- predict(fitnet, test)
table(predlog, test$label)
sum(predlog == test$label) / length(predlog)
table(prednet, test$label)
str(prednet)
prednet2 <- apply(prednet, 1, which.max)
str(prednet2)
prednet[1:4,]
prednet2 <- apply(prednet, 1, which.max) - 1
table(prednet2, test$label)
sum(prednet2 == test$label) / length(prednet2)
memory.size(train)
memory.size(fitnet)
trainALL <- read.csv("DigitRecognizer/train.csv")
train_ind <- sample(1:nrow(trainALL), size = .7*nrow(trainALL), replace = F)
train <- trainALL[train_ind,]
rm(train)
library(nnet)
fitlog <- multinom(factor(label) ~ ., data=trainALL, MaxNWts=1e6, maxit=200)
predlog <- predict(fitlog, testALL)
testALL <- read.csv("DigitRecognizer/test.csv")
sample_submission <- read.csv("DigitRecognizer/sample_submission.csv")
predlog <- predict(fitlog, testALL)
head(predlog)
head(sample_submission)
outDF <- data.frame(ImageId=1:length(predlog), Label=predlog)
head(outDF)
write.csv(x=outDF, file="multinomALL.csv")
str(outDF)
table(outDF$Label)
head(read.csv('DigitRecognizer/multinomSUBMISSION.csv'))
write.csv(x=outDF, file="multinomALL.csv", row.names = F)
head(read.csv('DigitRecognizer/multinomSUBMISSION.csv'))
head(read.csv('DigitRecognizer/multinomSUBMISSION.csv'))
write.csv(x=outDF, file="DigitRecognizer/multinomALL.csv", row.names = F)
head(read.csv('DigitRecognizer/multinomSUBMISSION.csv'))
write.csv(x=outDF, file="DigitRecognizer/multinomSUBMISSION.csv", row.names = F)
head(read.csv("DigitRecognizer/multinomSUBMISSION.csv"))
